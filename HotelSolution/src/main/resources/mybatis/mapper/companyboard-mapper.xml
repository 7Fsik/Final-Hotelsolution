<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="companyBoard">

	<select id="getAllCompanyBoardList" resultType="CompanyBoardVo">

		select
		no
		,category_no,
		writer_no
		,title
		,content
		,enroll_date
		,hit
		,status
		from board
		where status = 'N'

	</select>

	<select id="getAllCompanyBoardCnt" resultType="int">
		select
		count(no)
		from board
		where status ='N'
	</select>

	<select id="getBoardCategoryList" resultType="CategoryVo">
		select
		no
		,category_name
		from board_category
	</select>

	<insert id="writeCompanyBoardPost" parameterType="CompanyBoardVo">
		insert into board
		(
			no
			,category_no
			,writer_no
			,title
			,content
			,enroll_date)
		values
		(
			seq_board_no.nextval,
			#{categoryNo},
			#{writerNo},
			#{title},
			#{content},
			sysdate
		)
	</insert>

	<select id="increaseHit" resultType="int">
		update board
		set hit = hit + 1
		where no = #{no}
	</select>


	<select id="getCompanyBoardDetailByNo" resultType="CompanyBoardVo">
		select
		b.no
		,b.category_no
		,b.writer_no
		,b.title
		,b.content
		,b.enroll_date
		,b.hit
		,m.name as writerName
		from board b
		left join member m
		on b.no = m.no
		where b.no= #{no}
	</select>

	<update id="deleteByNo">
		update board
		set status = 'O'
		where no=#{NO}
	</update>

	<select id="getBoardInfoByNo" resultType="CompanyBoardVo">
		select
		no
		,category_no
		,writer_no
		,title
		,content
		,enroll_date
		from board
		where no= #{no}
	</select>

	<insert id="writeCommentByNo">
		insert into
		board_comment
		(
		comment_no
		,board_no
		,writer
		,comment_content
		,enroll_date
		,status
		,parent_comment_no
		,comment_depth
		)
		values
		(
		seq_board_comment_no.nextval
		,#{boardNo}
		,#{writer}
		,#{commentContent}
		,sysdate
		,default
		,0
		,0
		)
	</insert>



</mapper>
