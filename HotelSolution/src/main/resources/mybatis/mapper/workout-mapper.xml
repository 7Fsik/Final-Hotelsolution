<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="workout">
  
  
	<insert id="recordStartTime">
			
			INSERT INTO COMMUTE_RECORD 
			(NO, 
			USER_NO ,
			WORK_START_TIME,
            DAY_OF_WEEK)
		VALUES
			(SEQ_COMMUTE_RECORD_NO.NEXTVAL
			,#{no}
			,SYSDATE
            ,TO_CHAR(SYSDATE,'DAY'))
	
	</insert>
	
	<select id="getCommuteRecordNo" resultType="com.hotelsolution.fire.workout.vo.WorkoutVo">
		
		SELECT * FROM COMMUTE_RECORD
		WHERE USER_NO = #{no}
		ORDER BY NO DESC
		FETCH FIRST ROW ONLY
	
	</select>
	
	<update id="recordEndTime">
	
		UPDATE COMMUTE_RECORD SET
		WORK_END_TIME = SYSDATE
		WHERE NO = #{workoutNo}
	</update>
	
	<select id="getStartTime" resultType="java.util.Date">
	    SELECT WORK_START_TIME , DAY_OF_WEEK
	    FROM COMMUTE_RECORD
	    WHERE USER_NO = #{no}
	    AND WORK_START_TIME IS NOT NULL
        AND DAY_OF_WEEK IS NOT NULL
	    ORDER BY WORK_START_TIME DESC
	    FETCH FIRST ROW ONLY
	</select>

	<select id="getEndTime" resultType="java.util.Date">
	    SELECT WORK_END_TIME , DAY_OF_WEEK
	    FROM COMMUTE_RECORD
	    WHERE USER_NO = #{no}
	    AND WORK_END_TIME IS NOT NULL
	    AND DAY_OF_WEEK IS NOT NULL
	    ORDER BY WORK_END_TIME DESC
	    FETCH FIRST ROW ONLY
	</select>
	
	<select id="getAllWorkSession" resultType="com.hotelsolution.fire.work.session.WorkSession">
        SELECT *
        FROM COMMUTE_RECORD
        WHERE USER_NO = #{userNo}
    </select>
	
	<select id="getDayOfWeek" resultType="java.lang.String">
		SELECT DAY_OF_WEEK
		FROM COMMUTE_RECORD
		WHERE USER_NO = #{no}
		ORDER BY WORK_START_TIME DESC
		FETCH FIRST ROW ONLY
	</select>



</mapper>